# é¡¹ç›®_05

## æ»‘åŠ¨ç»„ä»¶

æˆ‘ä»¬çš„é¦–é¡µå·²ç»åŸºæœ¬å®Œæˆäº†ï¼Œä½†æ˜¯å‡ºç°äº†ä½“éªŒæ„Ÿçš„é—®é¢˜

> - æ»‘åŠ¨
>
>   - ç°åœ¨ä»£ç ä¸­æˆ‘ä»¬æ»‘åŠ¨å±å¹•ï¼Œæ»‘åŠ¨å¤šå°‘è·ç¦»å°±æ˜¯å¤šå°‘è·ç¦»ï¼Œå³ä½¿æ»‘åŠ¨åˆ°äº†ä¸€ä¸ªä¿¡æ¯ä¸€åŠçš„ä½ç½®ï¼Œç«‹å³åœæ­¢ï¼Œè¿™æ ·ä¸ä¸æ»‘ï¼Œæ¯”è¾ƒå¡é¡¿ï¼ŒåŒæ—¶ä¿¡æ¯å±•ç¤ºä¸å…¨ï¼Œç”¨æˆ·ä½“éªŒæ„Ÿè§‰ä¸å¥½
>   - æ‰€ä»¥æˆ‘ä»¬è¦åšä¸€ä¸ªå¹³æ»‘æ»‘åŠ¨
>
>   - ä»¥å‰ç»å¸¸ä½¿ç”¨`iscroll`ï¼Œä¸è¿‡ä½œè€…ä¸ç»´æŠ¤äº†ï¼Œä¸èƒ½ç”¨äº†
>   - æ ¹æ®`iscroll`çš„æºç ä¹‹é—´copyç‰ˆæœ¬çš„`better-scroll`æ›´åŠ å¥½ç”¨

æˆ‘ä»¬é¡¹ç›®ä¸­ä½¿ç”¨`better-scoll`çš„æ–¹å¼å®Œæˆä¸æ»‘æ»‘åŠ¨

å®˜æ–¹æ–‡æ¡£ï¼šhttps://better-scroll.github.io/docs/zh-CN/guide/

githubåœ°å€ï¼šhttps://github.com/ustbhuangyi/better-scroll

æºç ï¼šä¸€èˆ¬åœ¨githubé¡¹ç›®ä¸­-->æœ€æ–°tagä¸‹çš„distæ–‡ä»¶å¤¹

æˆ‘ä»¬åœ¨categoryä¸­æ¼”ç¤ºbetter-scrollçš„ä»£ç 

å®˜ç½‘ä¸­çš„ä½¿ç”¨

```js
<div class="wrapper">
  <ul class="content">
    <li>...</li>
    <li>...</li>
    ...
  </ul>
  <!-- è¿™é‡Œå¯ä»¥æ”¾ä¸€äº›å…¶å®ƒçš„ DOMï¼Œä½†ä¸ä¼šå½±å“æ»šåŠ¨ -->
</div>
```

ä¸Šé¢çš„ä»£ç ä¸­ BetterScroll æ˜¯ä½œç”¨åœ¨å¤–å±‚ **wrapper** å®¹å™¨ä¸Šçš„ï¼Œæ»šåŠ¨çš„éƒ¨åˆ†æ˜¯ **content** å…ƒç´ ã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒBetterScroll é»˜è®¤å¤„ç†å®¹å™¨ï¼ˆwrapperï¼‰çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼ˆcontentï¼‰çš„æ»šåŠ¨ï¼Œå…¶å®ƒçš„å…ƒç´ éƒ½ä¼šè¢«å¿½ç•¥ã€‚

æœ€ç®€å•çš„åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š

```js
import BScroll from '@better-scroll/core'
let wrapper = document.querySelector('.wrapper')
let scroll = new BScroll(wrapper)
```

BetterScroll æä¾›äº†ä¸€ä¸ªç±»ï¼Œå®ä¾‹åŒ–çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªåŸç”Ÿçš„ DOM å¯¹è±¡ã€‚å½“ç„¶ï¼Œå¦‚æœä¼ é€’çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒBetterScroll å†…éƒ¨ä¼šå°è¯•è°ƒç”¨ querySelector å»è·å–è¿™ä¸ª DOM å¯¹è±¡ã€‚

### æ»šåŠ¨åŸç†

æµè§ˆå™¨çš„æ»šåŠ¨åŸç†ï¼š æµè§ˆå™¨çš„æ»šåŠ¨æ¡å¤§å®¶éƒ½ä¼šé‡åˆ°ï¼Œ**å½“é¡µé¢å†…å®¹çš„é«˜åº¦è¶…è¿‡è§†å£é«˜åº¦çš„æ—¶å€™ï¼Œä¼šå‡ºç°çºµå‘æ»šåŠ¨æ¡ï¼›å½“é¡µé¢å†…å®¹çš„å®½åº¦è¶…è¿‡è§†å£å®½åº¦çš„æ—¶å€™ï¼Œä¼šå‡ºç°æ¨ªå‘æ»šåŠ¨æ¡**ã€‚ä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„è§†å£å±•ç¤ºä¸ä¸‹å†…å®¹çš„æ—¶å€™ï¼Œä¼šé€šè¿‡æ»šåŠ¨æ¡çš„æ–¹å¼è®©ç”¨æˆ·æ»šåŠ¨å±å¹•çœ‹åˆ°å‰©ä½™çš„å†…å®¹ã€‚

BetterScroll ä¹Ÿæ˜¯ä¸€æ ·çš„åŸç†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€å¼ å›¾æ›´ç›´è§‚çš„æ„Ÿå—ä¸€ä¸‹ï¼š

![image-20241025114535088](assets/image-20241025114535088.png)

ç»¿è‰²éƒ¨åˆ†ä¸º wrapperï¼Œä¹Ÿå°±æ˜¯çˆ¶å®¹å™¨ï¼Œå®ƒä¼šæœ‰**å›ºå®šçš„é«˜åº¦**ã€‚é»„è‰²éƒ¨åˆ†ä¸º contentï¼Œå®ƒæ˜¯çˆ¶å®¹å™¨çš„**ç¬¬ä¸€ä¸ªå­å…ƒç´ **ï¼Œå®ƒçš„é«˜åº¦ä¼šéšç€å†…å®¹çš„å¤§å°è€Œæ’‘é«˜ã€‚é‚£ä¹ˆï¼Œå½“ content çš„é«˜åº¦ä¸è¶…è¿‡çˆ¶å®¹å™¨çš„é«˜åº¦ï¼Œæ˜¯ä¸èƒ½æ»šåŠ¨çš„ï¼Œè€Œå®ƒä¸€æ—¦è¶…è¿‡äº†çˆ¶å®¹å™¨çš„é«˜åº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ»šåŠ¨å†…å®¹åŒºäº†ï¼Œè¿™å°±æ˜¯ BetterScroll çš„æ»šåŠ¨åŸç†ã€‚

> è¿™ä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬éœ€è¦å°†contentç»Ÿä¸€æˆä¸€ä¸ªå…ƒç´ ï¼Œä¸èƒ½æœ‰å¤šä¸ª
>
> ä¹‹å‰çš„ulä½œä¸ºå¤–éƒ¨çš„wrapper,100ä¸ªliä½œä¸ºcontentè¿™ä¸ªæ˜¯ä¸å…è®¸çš„
>
> éœ€è¦åœ¨å¤–å±‚åŒ…è£¹ä¸€ä¸ªdivå°†å…¶è®¾ç½®æˆwrapper,ç„¶åå°†ulæ•´ä½“ä½œä¸ºcontentè¿›è¡Œä½¿ç”¨

### ä½¿ç”¨Better-scroll

1. å®‰è£…better-scollï¼Œè¿è¡Œæ˜¯ä¾èµ–

```js
npm install better-scroll --save
```

2. ä½¿ç”¨

   - åˆ›å»º100ä¸ªliæ ‡ç­¾ç”¨äºæµ‹è¯•

   - åœ¨å›ºå®šé«˜åº¦ä¸­è¿›è¡Œæ»šåŠ¨

   - ä½¿ç”¨åŸç”Ÿçš„æ–¹å¼

```js
<template>
  <div class="wrapper">
    <div>
      <ul class="content">
        <li>åˆ†ç±»åˆ—è¡¨1</li>
        <li>åˆ†ç±»åˆ—è¡¨2</li>
        <li>åˆ†ç±»åˆ—è¡¨3</li>
        <li>åˆ†ç±»åˆ—è¡¨4</li>
        <li>åˆ†ç±»åˆ—è¡¨5</li>
        <li>åˆ†ç±»åˆ—è¡¨6</li>
        <li>åˆ†ç±»åˆ—è¡¨7</li>
        <li>åˆ†ç±»åˆ—è¡¨8</li>
        <li>åˆ†ç±»åˆ—è¡¨9</li>
        <li>åˆ†ç±»åˆ—è¡¨10</li>
        <li>åˆ†ç±»åˆ—è¡¨11</li>
        <li>åˆ†ç±»åˆ—è¡¨12</li>
        <li>åˆ†ç±»åˆ—è¡¨13</li>
        <li>åˆ†ç±»åˆ—è¡¨14</li>
        <li>åˆ†ç±»åˆ—è¡¨15</li>
        <li>åˆ†ç±»åˆ—è¡¨16</li>
        <li>åˆ†ç±»åˆ—è¡¨17</li>
        <li>åˆ†ç±»åˆ—è¡¨18</li>
        <li>åˆ†ç±»åˆ—è¡¨19</li>
        <li>åˆ†ç±»åˆ—è¡¨20</li>
        <li>åˆ†ç±»åˆ—è¡¨21</li>
        <li>åˆ†ç±»åˆ—è¡¨22</li>
        <li>åˆ†ç±»åˆ—è¡¨23</li>
        <li>åˆ†ç±»åˆ—è¡¨24</li>
        <li>åˆ†ç±»åˆ—è¡¨25</li>
        <li>åˆ†ç±»åˆ—è¡¨26</li>
        <li>åˆ†ç±»åˆ—è¡¨27</li>
        <li>åˆ†ç±»åˆ—è¡¨28</li>
        <li>åˆ†ç±»åˆ—è¡¨29</li>
        <li>åˆ†ç±»åˆ—è¡¨30</li>
        <li>åˆ†ç±»åˆ—è¡¨31</li>
        <li>åˆ†ç±»åˆ—è¡¨32</li>
        <li>åˆ†ç±»åˆ—è¡¨33</li>
        <li>åˆ†ç±»åˆ—è¡¨34</li>
        <li>åˆ†ç±»åˆ—è¡¨35</li>
        <li>åˆ†ç±»åˆ—è¡¨36</li>
        <li>åˆ†ç±»åˆ—è¡¨37</li>
        <li>åˆ†ç±»åˆ—è¡¨38</li>
        <li>åˆ†ç±»åˆ—è¡¨39</li>
        <li>åˆ†ç±»åˆ—è¡¨40</li>
        <li>åˆ†ç±»åˆ—è¡¨41</li>
        <li>åˆ†ç±»åˆ—è¡¨42</li>
        <li>åˆ†ç±»åˆ—è¡¨43</li>
        <li>åˆ†ç±»åˆ—è¡¨44</li>
        <li>åˆ†ç±»åˆ—è¡¨45</li>
        <li>åˆ†ç±»åˆ—è¡¨46</li>
        <li>åˆ†ç±»åˆ—è¡¨47</li>
        <li>åˆ†ç±»åˆ—è¡¨48</li>
        <li>åˆ†ç±»åˆ—è¡¨49</li>
        <li>åˆ†ç±»åˆ—è¡¨50</li>
        <li>åˆ†ç±»åˆ—è¡¨51</li>
        <li>åˆ†ç±»åˆ—è¡¨52</li>
        <li>åˆ†ç±»åˆ—è¡¨53</li>
        <li>åˆ†ç±»åˆ—è¡¨54</li>
        <li>åˆ†ç±»åˆ—è¡¨55</li>
        <li>åˆ†ç±»åˆ—è¡¨56</li>
        <li>åˆ†ç±»åˆ—è¡¨57</li>
        <li>åˆ†ç±»åˆ—è¡¨58</li>
        <li>åˆ†ç±»åˆ—è¡¨59</li>
        <li>åˆ†ç±»åˆ—è¡¨60</li>
        <li>åˆ†ç±»åˆ—è¡¨61</li>
        <li>åˆ†ç±»åˆ—è¡¨62</li>
        <li>åˆ†ç±»åˆ—è¡¨63</li>
        <li>åˆ†ç±»åˆ—è¡¨64</li>
        <li>åˆ†ç±»åˆ—è¡¨65</li>
        <li>åˆ†ç±»åˆ—è¡¨66</li>
        <li>åˆ†ç±»åˆ—è¡¨67</li>
        <li>åˆ†ç±»åˆ—è¡¨68</li>
        <li>åˆ†ç±»åˆ—è¡¨69</li>
        <li>åˆ†ç±»åˆ—è¡¨70</li>
        <li>åˆ†ç±»åˆ—è¡¨71</li>
        <li>åˆ†ç±»åˆ—è¡¨72</li>
        <li>åˆ†ç±»åˆ—è¡¨73</li>
        <li>åˆ†ç±»åˆ—è¡¨74</li>
        <li>åˆ†ç±»åˆ—è¡¨75</li>
        <li>åˆ†ç±»åˆ—è¡¨76</li>
        <li>åˆ†ç±»åˆ—è¡¨77</li>
        <li>åˆ†ç±»åˆ—è¡¨78</li>
        <li>åˆ†ç±»åˆ—è¡¨79</li>
        <li>åˆ†ç±»åˆ—è¡¨80</li>
        <li>åˆ†ç±»åˆ—è¡¨81</li>
        <li>åˆ†ç±»åˆ—è¡¨82</li>
        <li>åˆ†ç±»åˆ—è¡¨83</li>
        <li>åˆ†ç±»åˆ—è¡¨84</li>
        <li>åˆ†ç±»åˆ—è¡¨85</li>
        <li>åˆ†ç±»åˆ—è¡¨86</li>
        <li>åˆ†ç±»åˆ—è¡¨87</li>
        <li>åˆ†ç±»åˆ—è¡¨88</li>
        <li>åˆ†ç±»åˆ—è¡¨89</li>
        <li>åˆ†ç±»åˆ—è¡¨90</li>
        <li>åˆ†ç±»åˆ—è¡¨91</li>
        <li>åˆ†ç±»åˆ—è¡¨92</li>
        <li>åˆ†ç±»åˆ—è¡¨93</li>
        <li>åˆ†ç±»åˆ—è¡¨94</li>
        <li>åˆ†ç±»åˆ—è¡¨95</li>
        <li>åˆ†ç±»åˆ—è¡¨96</li>
        <li>åˆ†ç±»åˆ—è¡¨97</li>
        <li>åˆ†ç±»åˆ—è¡¨98</li>
        <li>åˆ†ç±»åˆ—è¡¨99</li>
        <li>åˆ†ç±»åˆ—è¡¨100</li>
      </ul>
    </div>
  </div>
</template>

<script>
export default {
  name: "Category",
}
</script>

<style scoped>
.wrapper {
  // è®¾ç½®å›ºå®šé«˜åº¦
  height: 150px;
  background-color: red;

  // è®¾ç½®è¿™ä¸ªå±æ€§ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿçš„æ»šåŠ¨æ–¹å¼
  overflow-y: scroll;
}
</style>
```

æ•ˆæœå±•ç¤º

![123446](assets/123446-17298273697231.gif)

3. ä½¿ç”¨better-scrollè¿›è¡Œæ”¹è¿›
   - ä¸èƒ½ä½¿ç”¨createdæ˜¯åœ¨åˆ›å»ºå®Œæˆå°±æ¶ˆå¤±äº†
     - .wrapperçš„æ–¹å¼æ‹¿åˆ°çš„ä¸æ˜¯undefinedã€nullï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•å¯¹å…ƒç´ è¿›è¡Œæ“ä½œ
   - ä½†æ˜¯æˆ‘ä»¬çš„é¡µé¢æ»šåŠ¨æ˜¯éœ€è¦ä¸æ–­çš„åˆ·æ–°çš„ï¼Œæ‰€ä»¥æ¯æ¬¡åˆ·æ–°çš„æ—¶å€™ï¼Œéƒ½éœ€è¦ä½¿ç”¨å¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨mountedæ›´æ–°

```js
// å¯¼å…¥better-scroll
import BScroll from 'better-scroll'

data() {
  return {
    scroll: null
  }
},
mounted() {
  this.scroll = new BScroll(this.$refs.aaaa, {
    
  })
}
```

å®Œæˆæ»šåŠ¨

![123446](assets/123446-17298289961422.gif)

ä½¿ç”¨`overflow: hidden;`å°†æº¢å‡ºéƒ¨åˆ†éšè—å³å¯

åº•éƒ¨ä¼šå‡ºç°**å¼¹ç°§æ•ˆæœ**

æ•ˆæœå±•ç¤º

![123446](assets/123446-17298291355603.gif)

### Better-scrollç‰¹æ€§

#### probeType

> **å¯¹åº”é¡¹ç›®åŠŸèƒ½**ï¼šå®æ—¶ç›‘å¬ä½ç½®ï¼Œæ˜¾ç¤ºto-top

```js
// ç±»å‹ï¼šnumber
// é»˜è®¤å€¼ï¼š0
// å¯é€‰å€¼ï¼š1|2|3
// ä½œç”¨ï¼šå†³å®šæ˜¯å¦æ´¾å‘ scroll äº‹ä»¶ï¼Œå¯¹é¡µé¢çš„æ€§èƒ½æœ‰å½±å“ï¼Œå°¤å…¶æ˜¯åœ¨ useTransition ä¸º true çš„æ¨¡å¼ä¸‹ã€‚

// æ´¾å‘ scroll çš„åœºæ™¯åˆ†ä¸ºä¸¤ç§ï¼š
// 1. æ‰‹æŒ‡ä½œç”¨åœ¨æ»šåŠ¨åŒºåŸŸï¼ˆcontent DOMï¼‰ä¸Š;
// 2. è°ƒç”¨ scrollTo æ–¹æ³•æˆ–è€…è§¦å‘ momentum æ»šåŠ¨åŠ¨ç”»ï¼ˆå…¶å®åº•å±‚è¿˜æ˜¯è°ƒç”¨ scrollTo æ–¹æ³•ï¼‰

// å¯¹äº v2.1.0 ç‰ˆæœ¬ï¼Œå¯¹ probeType åšäº†ä¸€æ¬¡ç»Ÿä¸€

// 1. probeType ä¸º 0ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½ä¸æ´¾å‘ scroll äº‹ä»¶ï¼Œ
// 2. probeType ä¸º 1ï¼Œä»…ä»…å½“æ‰‹æŒ‡æŒ‰åœ¨æ»šåŠ¨åŒºåŸŸä¸Šï¼Œæ¯éš” momentumLimitTime æ¯«ç§’æ´¾å‘ä¸€æ¬¡ scroll äº‹ä»¶ï¼Œ
// 3. probeType ä¸º 2ï¼Œä»…ä»…å½“æ‰‹æŒ‡æŒ‰åœ¨æ»šåŠ¨åŒºåŸŸä¸Šï¼Œä¸€ç›´æ´¾å‘ scroll äº‹ä»¶ï¼Œ
// 4. probeType ä¸º 3ï¼Œä»»ä½•æ—¶å€™éƒ½æ´¾å‘ scroll äº‹ä»¶ï¼ŒåŒ…æ‹¬è°ƒç”¨ scrollTo æˆ–è€…è§¦å‘ momentum æ»šåŠ¨åŠ¨ç”»

bscroll.on('scroll',position=>{
    console.log(position)
})
// é»˜è®¤æƒ…å†µä¸‹BScrollæ˜¯ä¸å¯ä»¥å®æ—¶çš„ç›‘å¬æ»šåŠ¨çš„ä½ç½®çš„
// probe ä¾¦æµ‹
// 1. probeType ä¸º 0ï¼Œä¸ä¾¦æµ‹å®æ—¶ä½ç½®
// 2. probeType ä¸º 1ï¼Œä¸ä¾¦æµ‹å®æ—¶ä½ç½®
// 3. probeType ä¸º 2ï¼Œä»…ä»…å½“æ‰‹æŒ‡æ»šåŠ¨çš„è¿‡ç¨‹ä¸­ä¾¦æµ‹ï¼Œæ‰‹æŒ‡ç¦»å¼€åçš„æƒ¯æ€§æ»šåŠ¨è¿‡ç¨‹ä¸­ä¸ä¾¦æµ‹
// 4. probeType ä¸º 3ï¼Œåªè¦æ˜¯æ»šåŠ¨ï¼Œæ‰‹æŒ‡ + æƒ¯æ€§éƒ½ä¾¦æµ‹
```

#### click

> **å¯¹åº”é¡¹ç›®åŠŸèƒ½**ï¼šç›‘å¬å†…æŒ‰é’®ä¸èƒ½ç‚¹å‡»(buttonçš„clickå¯ä»¥)ï¼Œéœ€è¦è®¾ç½®true

```js
// click
// ç±»å‹ï¼šboolean
// é»˜è®¤å€¼ï¼šfalse
// ä½œç”¨ï¼šBetterScroll é»˜è®¤ä¼šé˜»æ­¢æµè§ˆå™¨çš„åŸç”Ÿ click äº‹ä»¶ã€‚å½“è®¾ç½®ä¸º trueï¼ŒBetterScroll ä¼šæ´¾å‘ä¸€ä¸ª click äº‹ä»¶ï¼Œæˆ‘ä»¬ä¼šç»™æ´¾å‘çš„ event å‚æ•°åŠ ä¸€ä¸ªç§æœ‰å±æ€§ _constructedï¼Œå€¼ä¸º trueã€‚
```

```js
methods: {
	btnClick() {
		console.log('btnClick');
    },
	divClick() {
		console.log('divClick');
	}
}
```

- æ— è®ºæ˜¯å¦è®¾ç½®`click:false`, buttonéƒ½å¯ä»¥ç‚¹å‡»
- è‡ªå®šä¹‰çš„ç‚¹å‡»äº‹ä»¶ï¼šå¿…é¡»è®¾ç½®`click:true`, é‚£ä¹ˆdivæ‰èƒ½ç›‘å¬ç‚¹å‡»

![123446](assets/123446-17298326315466.gif)

#### pullUpLoad

>  **å¯¹åº”é¡¹ç›®åŠŸèƒ½**ï¼šä¸Šæ‹‰åŠ è½½æ›´å¤š

```js
1. é€šè¿‡é™æ€æ–¹æ³• BScroll.use() æ³¨å†Œæ’ä»¶
import BScroll from '@better-scroll/core'
import Pullup from '@better-scroll/pull-up'

BScroll.use(Pullup)

2. ç„¶åï¼Œå®ä¾‹åŒ– BetterScroll æ—¶éœ€è¦ä¼ å…¥ pullup é…ç½®é¡¹ã€‚
new BScroll('.bs-wrapper', {
    pullUpLoad: true
})
```

ç¤ºä¾‹ä»£ç ï¼š

> `this.bscroll.on('pullingUp', this.pullingUpHandler)` å®é™…ä¸Šå¼€å¯äº†è¿™ä¸ªå±æ€§ å°±èƒ½å¯¹`pullingUp`äº‹ä»¶è¿›è¡Œç›‘å¬ï¼Œä¸Šé¢æˆ‘ä»¬æ˜¯é’ˆå¯¹scrolläº‹ä»¶è¿›è¡Œç›‘å¬
>
> `pullingUp(pull-up)`
>
> - **è§¦å‘æ—¶æœº**ï¼šå½“åº•éƒ¨ä¸‹æ‹‰è·ç¦»è¶…è¿‡é˜ˆå€¼

```js
// template
<template>
  <div class="pullup">
    <div ref="scroll" class="pullup-wrapper">
      <div class="pullup-content">
        <ul class="pullup-list">
          <li v-for="i of data" :key="i" class="pullup-list-item">
            {{ i % 5 === 0 ? 'scroll up ğŸ‘†ğŸ»' : `I am item ${i} `}}
          </li>
        </ul>
        <div class="pullup-tips">
          <div v-if="!isPullUpLoad" class="before-trigger">
            <span class="pullup-txt">Pull up and load more</span>
          </div>
          <div v-else class="after-trigger">
            <span class="pullup-txt">Loading...</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

// scriptè„šæœ¬
<script>
  import BScroll from '@better-scroll/core'
  import Pullup from '@better-scroll/pull-up'

  BScroll.use(Pullup)

  export default {
    data() {
      return {
        isPullUpLoad: false,
        data: 30
      }
    },
    mounted() {
      this.initBscroll()
    },
    methods: {
      initBscroll() {
        this.bscroll = new BScroll(this.$refs.scroll, {
          pullUpLoad: true
        })

        this.bscroll.on('pullingUp', this.pullingUpHandler)
      },
      async pullingUpHandler() {
        this.isPullUpLoad = true

        await this.requestData()

        this.bscroll.finishPullUp()
        this.bscroll.refresh()
        this.isPullUpLoad = false
      },
      async requestData() {
        try {
          const newData = await this.ajaxGet(/* url */)
          this.data += newData
        } catch (err) {
          // handle err
          console.log(err)
        }
      },
      ajaxGet(/* url */) {
        return new Promise(resolve => {
          setTimeout(() => {
            resolve(20)
          }, 1000)
        })
      }
    }
  }
</script>

// styleæ ·å¼
<style lang="stylus" scoped>
.pullup
  height: 100%
  .pullup-wrapper
    height: 100%
    padding: 0 10px
    border: 1px solid #ccc
    overflow: hidden
  .pullup-list
    padding: 0
  .pullup-list-item
    padding: 10px 0
    list-style: none
    border-bottom: 1px solid #ccc
  .pullup-tips
    padding: 20px
    text-align: center
    color: #999
</style>
```

![123446](assets/123446-17298307791524.gif)

å¯¹categoryä»£ç è¿›è¡Œæ›´æ–°

```js
mounted() {
  this.scroll = new BScroll(this.$refs.aaaa, {
    probeType: 3,
    pullUpLoad: true
  })

  this.scroll.on('scroll', (position) => {
    console.log(position);
  })

  this.scroll.on('pullingUp', () => {
    console.log('ä¸Šå•¦åŠ è½½æ›´å¤š');
  })
}
```

![image-20241025124232928](assets/image-20241025124232928.png)

> ä¸Šæ‹‰åŠ è½½æ›´å¤šåªä¼šå±•ç¤ºä¸€æ¬¡ï¼Œéœ€è¦æ£€æµ‹å½“å‰ä¸Šæ‹‰åŠ è½½æ›´å¤šçš„åŠ¨ä½œå·²ç»å®Œæˆ

```js
this.scroll.on('pullingUp', () => {
    console.log('ä¸Šå•¦åŠ è½½æ›´å¤š');
    // å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¯·æ±‚æ›´å¤šé¡µçš„ä¸€ä¸ªæ•°æ®

    // ç­‰æ•°æ®è¯·æ±‚å®Œæˆï¼Œå¹¶å°†æ–°çš„æ•°æ®å±•ç¤ºå‡ºæ¥å
    this.scroll.finishPullUp()
})
```

æ•ˆæœå±•ç¤º

![123446](assets/123446-17298318385745.gif)

æˆ‘ä»¬è¿˜å¯ä»¥å°†è¿™ä¸ª`finishPullUp` å‡½æ•°æ”¾å…¥åˆ°`setTimeout`å‡½æ•°ä¸­ï¼Œåœ¨æŒ‡å®šäº‹ä»¶å†…æˆ‘ä»¬ä¸èƒ½ä¸æ–­åˆ·æ–°ï¼Œå½“æ—¶é—´ä¸€åˆ°æˆ‘ä»¬å¯å†æ¬¡åˆ·æ–°

```js
this.scroll.on('pullingUp', () => {
    console.log('ä¸Šå•¦åŠ è½½æ›´å¤š');
    // å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¯·æ±‚æ›´å¤šé¡µçš„ä¸€ä¸ªæ•°æ®

    // ç­‰æ•°æ®è¯·æ±‚å®Œæˆï¼Œå¹¶å°†æ–°çš„æ•°æ®å±•ç¤ºå‡ºæ¥å
    setTimeout(()=>{
    	this.scroll.finishPullUp()
    },2000)
})
```

### å°è£…Better-scroll

> è¿˜æ˜¯å’Œaxiosçš„å°è£…ä¸€ä¸ªé“ç†ï¼Œå½“æˆ‘ä»¬ç›´æ¥ä½¿ç”¨çš„æ—¶å€™ï¼Œé¡¹ç›®å¯¹Better-scrollçš„ä¾èµ–å¤ªé«˜ï¼Œå½“Better-scrollä¸åœ¨ç»´æŠ¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹å¤§é‡çš„é¡¹ç›®ä»£ç ï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦éš”ç¦»é¡¹ç›®å’ŒBetter-scrollçš„ä¾èµ–ï¼Œå°†Better-scrollè¿›è¡Œå°è£…ï¼Œé™ä½è€¦åˆåº¦

åœ¨components/commonä¸­ï¼Œåˆ›å»ºä¸€ä¸ª`scroll`æ–‡ä»¶å¤¹ï¼Œå®šä¹‰`Scroll.vue`ç»„ä»¶

> `this.scroll = new BScroll(this.$refs.wrapper, {})` æ›´ä¼˜ç§€
>
> `this.scroll = new BScroll(this.$refs.wrapper, {})` æ¯” `this.scroll = new BScroll(document.querySelector('.wrapper'), {})`æ›´å¥½çš„åŸå› æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨`document.querySelector('.wrapper')`çš„æ–¹å¼ï¼Œå½“æˆ‘ä»¬é¡¹ç›®ä¸­æœ‰å¾ˆå¤šçš„åœ°æ–¹å¼•ç”¨äº†`.wrapper`å±æ€§ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ‹¿é”™ï¼Œå› ä¸º`document.querySelector`æ˜¯æŒ‰ç…§é¡ºåºæŸ¥æ‰¾ï¼Œä»£ç å±‚æ¬¡æ¸æ·±çš„æ—¶å€™ï¼Œæœ€ç»ˆä¼šäº§ç”Ÿé—®é¢˜éš¾ä»¥å¯Ÿè§‰ï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦ä½¿ç”¨`document.querySelector('.wrapper')`çš„æ–¹å¼

**this.$refs.åç§°**

- çˆ¶ç»„ä»¶ä¸­æ‹¿åˆ°æŒ‡å®šåç§°çš„å­ç»„ä»¶çš„æ—¶å€™ä½¿ç”¨ ref = 'åç§°'
- åœ¨**æ™®é€šæ ‡ç­¾**ä¸­æ·»åŠ ref = 'åç§°' çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™ç§æ–¹å¼this.$refs.åç§°ï¼Œæ‹¿åˆ°æŒ‡å®šå…ƒç´ 

å®Œæ•´ä»£ç 

```js
<template>
  <div class="wrapper" ref="wrapper">
    <div class="content">
      <slot></slot>
    </div>
  </div>
</template>

<script>
  import BScroll from 'better-scroll'

  export default {
    name: "Scroll",
    data() {
      return {
        scroll: null,
      }
    },

    mounted() {
      // 1.åˆ›å»ºBScrollå¯¹è±¡
      this.scroll = new BScroll(this.$refs.wrapper, {
        click: true,
        probeType: this.probeType,
        pullUpLoad: this.pullUpLoad
      })
    },
  }
</script>

<style scoped>

</style>

```

åœ¨home.vueä¸­å¼•å…¥

```js
// å¼•ç”¨
<scroll class="content"
        ref="scroll"
        :probe-type="3"
        :pull-up-load="true">
  <home-swiper :banners="banners"></home-swiper>
  <recommend-view :recommends="recommends"></recommend-view>
  <feature-view></feature-view>
  <tab-control :titles="['æµè¡Œ', 'æ–°æ¬¾', 'ç²¾é€‰']"
               class="tab-control"
               @tabClick="tabClick"/>
  <good-list :goods="showGoods"/>
</scroll>

// å¯¼å…¥å­ç»„ä»¶
import Scroll from 'components/common/scroll/Scroll'

// åŠ è½½
components: {
  NavBar,
  HomeSwiper,
  RecommendView,
  FeatureView,
  TabControl,
  GoodList,
  Scroll
},
    
// æ·»åŠ æ ·å¼
.content {
  overflow: hidden;

  position: absolute;
  top: 44px;
  bottom: 49px;
  left: 0;
  right: 0;
}
```

æ•ˆæœå±•ç¤º(æœªæˆåŠŸ)

- é¡µé¢åªæ˜¯è½»å¾®å‘ä¸Šï¼Œå¹¶æœªå®ç°çœŸæ­£çš„å‘ä¸Šæ»‘åŠ¨
- è€Œä¸”æœ‰çš„æ—¶å€™å¯ä»¥å‘ä¸Šæ»‘åŠ¨å¾ˆå¤šï¼Œä½†æ˜¯åˆ°ä¸€å®šä½ç½®å¡ä½ï¼›æœ‰æ—¶å€™ç›´æ¥å°±æ˜¯ä¸èƒ½å‘ä¸Šæ»šåŠ¨

![123446](assets/123446-17298495577997.gif)

> **è¿™é‡Œçš„æ€»ç»“é¡ºåºå’Œè€å¸ˆè®²è¯¾é¡ºåºä¸ä¸€è‡´ï¼Œå…ˆè§£å†³äº†bugï¼Œç„¶ååœ¨å®ç°to-topå’Œä¸Šæ‹‰åŠ è½½æ›´å¤šåŠŸèƒ½**

### æ»šä¸åŠ¨bug

è¿™ä¸ªé—®é¢˜å…¶å®æ˜¯ä¸€ä¸ªbug

ä¸‹é¢æ˜¯bugçš„è¯¦ç»†åŸå› å’Œè§£å†³è¿‡ç¨‹

è¯¦ç»†åŸå› ï¼š

better-scrollåœ¨å†³å®šæ•´ä¸ªåŒºåŸŸä¸­æœ‰å¤šå°‘ä¸ªå†…å®¹å¯ä»¥æ»šåŠ¨ï¼Œå…¶å®æ˜¯å–å†³äºå†…å®¹çš„é•¿åº¦æ¥å†³å®šçš„ï¼Œæ ¸å¿ƒå°±æ˜¯éå†æ•´ä¸ªåŒºåŸŸä¸­å†…å®¹çš„é•¿åº¦ï¼Œç„¶åè¿›è¡Œç´¯åŠ ï¼Œ

![image-20241027085440368](assets/image-20241027085440368.png)



![image-20241027093425912](assets/image-20241027093425912.png)

æˆ‘ä»¬å¯ä»¥é€šè¿‡better-scrollçš„å±æ€§`scrollerHeight`å¾—åˆ°å¯æ»šåŠ¨è·ç¦»

> - é—®é¢˜ï¼š
>
>   - better-scrollåœ¨å†³å®šæœ‰å¤šå°‘åŒºåŸŸå¯ä»¥æ»šåŠ¨æ—¶å€™ï¼Œæ˜¯æ ¹æ®å±æ€§`scrollerHeight`å†³å®šçš„
>
>   - å±æ€§`scrollerHeight`æ˜¯æ ¹æ®æ”¾åœ¨berrer-scrollçš„contentçš„å­ç»„ä»¶çš„é«˜åº¦å†³å®šçš„
>
>   - ä½†æ˜¯æˆ‘ä»¬çš„é¦–é¡µä¸­ï¼Œåˆšå¼€å§‹è®¡ç®—å‡ºæ¥çš„å±æ€§`scrollerHeight`ï¼Œæ˜¯æ²¡æœ‰å°†å›¾ç‰‡è®¡ç®—åœ¨å†…çš„
>
>   - æ‰€ä»¥è®¡ç®—å‡ºæ¥çš„å±æ€§æ˜¯é”™è¯¯çš„
>
>   - åæ¥å›¾ç‰‡åŠ è½½è¿›æ¥äº†ä»¥åå°±æœ‰äº†æ–°çš„é«˜åº¦ï¼Œä½†æ˜¯å±æ€§`scrollerHeight`å¹¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥æ»šåŠ¨å‡ºç°äº†é—®é¢˜
>
> - è§£å†³é—®é¢˜ï¼š
>   - ç›‘å¬æ¯ä¸€å¼ å›¾ç‰‡æ˜¯å¦åŠ è½½å®Œæˆï¼Œåªè¦æœ‰ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆäº†ï¼Œå°±æ‰§è¡Œä¸€æ¬¡refresh()
>   - æ–°é—®é¢˜ï¼šä»€ä¹ˆæ—¶å€™æ‰€æœ‰å›¾ç‰‡åŠ è½½å®Œæˆé‚£ï¼Ÿ
>     - åœ¨jsä¸­img.onload = function abc() `onload`å‡½æ•°å®ç°å¯¹å›¾ç‰‡åŠ è½½å®Œæˆçš„æ£€æµ‹
>     - åœ¨vueä¸­ï¼Œåœ¨imgæ ‡ç­¾ä¸­@loadå‡½æ•°å°±èƒ½ç›‘å¬çš„åˆ°å›¾ç‰‡åŠ è½½å®Œæˆ

![image-20241027094424499](assets/image-20241027094424499.png)

å›¾ç‰‡åŠ è½½å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨scroll.refresh()å‡½æ•°é‡æ–°è®¡ç®—contentçš„é«˜åº¦ï¼Œé€šçŸ¥better-scrollç»„ä»¶å°±è¡Œäº†

å¯¹GoodListItem.vueä¸­çš„å›¾ç‰‡è¿›è¡Œç›‘å¬

```js
<img :src="goodsItem.show.img" alt="" @load="imageLoad">
    
imageLoad() {
  console.log('itemImageLoad')
},
```

![image-20241027100051860](assets/image-20241027100051860.png)

åˆå‡ºç°ä¸ªæ–°é—®é¢˜ï¼šåœ¨goodsListItemä¸­æ€æ ·è°ƒç”¨scrollç»„ä»¶scrollå¯¹è±¡çš„refreshæ–¹æ³•

- ç¬¬ä¸€ç§æ–¹å¼

  ![image-20241027101417599](assets/image-20241027101417599.png)

- ç¬¬äºŒç§æ–¹å¼

  ![image-20241027102102276](assets/image-20241027102102276.png)

- ç¬¬ä¸‰ç§æ–¹å¼(éå¸¸é€‚åˆ)

  ![image-20241027104014041](assets/image-20241027104014041.png)

å¯¹`GoodListItem.vue`ä¸­çš„å›¾ç‰‡è¿›è¡Œç›‘å¬

```js
<img :src="goodsItem.show.img" alt="" @load="imageLoad">
    
imageLoad() {
  this.$bus.$emit('itemImageLoad')
},
```

åœ¨homeä¸­å¯¹æ€»çº¿äº‹ä»¶è¿›è¡Œç›‘å¬

```js
created() {
  // æ€»çº¿äº‹ä»¶ç›‘å¬
  this.$bus.$on('itemImageLoad',()=>{
      console.log('-----');
  })
},
```

åœ¨Vueä¸­å…¶å®æ˜¯æ²¡æœ‰æ€»çº¿çš„ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±è¿›è¡Œåˆ›å»ºï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªvueå¯¹è±¡

åœ¨main.jsä¸­å®Œæˆåˆ›å»º

```js
// åœ¨åŸå‹é“¾ä¸Šæ·»åŠ ä¸€ä¸ªVueå®ä¾‹
Vue.prototype.$bus = new Vue()
```

> TODOï¼š**why** Vueå®ä¾‹å¯ä»¥ä½œä¸ºä¸€ä¸ªæ€»çº¿å¯¹è±¡ï¼Ÿ

![image-20241027104304628](assets/image-20241027104304628.png)

åœ¨scroll.vueä¸­æ·»åŠ refreshæ–¹æ³•çš„è°ƒç”¨å°è£…

```js
methods: {
  refresh() {
    this.scroll && this.scroll.refresh()
  }
}
```

åœ¨home.vueä¸­å®Œæˆè°ƒç”¨

```js
this.$bus.$on('itemImageLoad',()=>{
    this.$refs.scroll.refresh()
})
```

æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š

![123446](assets/123446-17299972161342.gif)

bugå·²ç»è§£å†³äº†ï¼Œå¯ä»¥ä¸æ»‘çš„å‘ä¸Šæ»šåŠ¨äº†

åˆå‡ºç°äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šrefreshå‡½æ•°æ‰¾ä¸åˆ°

![image-20241025190715206](assets/image-20241025190715206.png)

> åŸå› ï¼šå…¶å®æ˜¯å› ä¸ºæˆ‘ä»¬å°†refreshå‡½æ•°è°ƒç”¨æ”¾åœ¨äº†createdä¸­ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„scrollç»„ä»¶å¯èƒ½è¿˜æ²¡æœ‰åŠ è½½å®Œæˆï¼Œå°±æ²¡æœ‰scrollç»„ä»¶ï¼Œæ‰€ä»¥è°ƒç”¨refreshç»„ä»¶è°ƒç”¨æ‰¾ä¸åˆ°
>
> - åœ¨createdä¸­å»ä½¿ç”¨document.querySelector() or this.$refs.xxx æ‹¿åˆ°çš„ä¸œè¥¿å¯èƒ½éƒ½æ˜¯ç©ºçš„

å¯¹scroll.vueå¯¹è±¡è¿›è¡Œä¿®æ”¹ä¼˜åŒ–ï¼Œæ·»åŠ å¯¹äºscrollå¯¹è±¡å­˜åœ¨çš„åˆ¤æ–­

```js
methods: {
  refresh() {
    this.scroll && this.scroll.refresh()
  },
}
```

åŒæ—¶home.vueå°†ç›‘å¬ä»createdä¸­æ›´æ”¹åˆ°mountedä¸­ï¼Œæ›´æ”¹ä»£ç 

```js
mounted() {
  // 1.å›¾ç‰‡åŠ è½½å®Œæˆçš„äº‹ä»¶ç›‘å¬
  this.$bus.$on('itemImageLoad', () => {
    this.$refs.scroll.refresh()
  })
},
```

### é˜²æŠ–

> å®é™…éœ€æ±‚ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸èƒ½ç”¨åˆ°æœç´¢æ¡†ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå­—ç¬¦å°±ä¼šæœ‰ç›¸å¯¹åº”çš„æ¨èè¯æ¡ç»™åˆ°æˆ‘ä»¬ï¼Œå…¶å®å°±æ˜¯å‘åç«¯å‘é€äº†ä¸€æ¡è¯·æ±‚ï¼Œå°†æœ€æ–°çš„æ¨èæ¨èç»™ç”¨æˆ·
>
> - æˆ‘ä»¬è¾“å…¥3ä¸ªå­—ç¬¦ï¼Œå‘é€ä¸‰ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬è¾“å…¥4ä¸ªå­—ç¬¦ï¼Œå‘é€4ä¸ªè¯·æ±‚â€¦â€¦
>
> å…¶å®ç”¨æˆ·å¯èƒ½æƒ³è¦æœç´¢ä¸€ä¸ªå›ºå®šçš„ä¸œè¥¿ï¼Œå¹¶ä¸éœ€è¦æˆ‘ä»¬å®æ—¶çš„å˜åŒ–ï¼Œæˆ–è€…ç”¨æˆ·è¾“å…¥è¾ƒå¿«ï¼Œç¬¬ä¸‰ä¸ªçš„å±•ç¤ºè¿˜æ²¡åˆ·æ–°ï¼Œä»–å·²ç»è¾“å…¥äº†ç¬¬å››ä¸ªå­—ç¬¦äº†
>
> ä¸¤ä¸ªé—®é¢˜ï¼š
>
> 1. æˆ‘ä»¬å¹¶ä¸éœ€è¦æ¯ä¸ªå­—ç¬¦éƒ½è¿›è¡Œåˆ·æ–°
> 2. æˆ‘ä»¬æ¯ä¸ªå­—ç¬¦éƒ½å‘åç«¯è¿›è¡Œå‘é€è¯·æ±‚ï¼Œç»™åç«¯çš„å‹åŠ›ä¹Ÿæ˜¯å¾ˆå¤§çš„
>
> è§£å†³é—®é¢˜çš„æ–¹å¼:
>
> - æˆ‘ä»¬å¯ä»¥æ¯é—´éš”ä¸€æ®µæ—¶é—´ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œä¸€æ¬¡æ±‡æ€»ä¹‹åï¼Œåœ¨å°†è¯·æ±‚å‘ç»™åç«¯ï¼Œæ‹¿åˆ°ç›¸å¯¹åº”çš„æ•°æ®ååœ¨æ›´æ–°ç•Œé¢
> - æ±‡æ€»æ“ä½œå°±æ˜¯å°±æ˜¯ï¼šåœ¨é—´éš”æ—¶é—´å†…ï¼Œå°†å¤šæ¬¡è¯·æ±‚è¿›è¡Œå–æ¶ˆï¼Œé—´éš”æ—¶é—´åˆ°çš„æ—¶å€™ï¼Œå°†æœ€åè¾“å…¥ä½œä¸ºä¸€ä¸ªæ•´ä½“å‘é€ç»™åç«¯
>
> æ ¸å¿ƒå°±æ˜¯ï¼š**é˜²æŠ–å°±æ˜¯è§¦å‘äº‹ä»¶åªèƒ½åœ¨nç§’æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœnç§’å†…å†æ¬¡æ‰§è¡Œï¼Œåˆ™ä¼šé‡æ–°è®¡åˆ’æ‰§è¡Œæ—¶é—´**
>
> ![image-20241027120238109](assets/image-20241027120238109.png)
>
> è¿™ä¸ªæŠ€æœ¯å°±æ˜¯ `é˜²æŠ–`
>
> å½“æˆ‘ä»¬å‡½æ•°ä¸­ä¸ä¼ delayå‚æ•°ï¼Œæˆ‘ä»¬çš„refreshæ‰“å°ä¹Ÿä¸æ˜¯ä¸‰åæ¬¡
>
> - æ˜¯å› ä¸ºsetTimeoutå‡½æ•°æ˜¯æ”¾åœ¨ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­
>
> - ```js
>   console.log('aaa');
>   setTimeout(() => {
>       console.log('bbb');
>   })
>   console.log('ccc');
>   
>   // æ‰“å°é¡ºåº aaa --> ccc ---> bbb
>   ```

åœ¨commonä¸‹å»ºç«‹ä¸€ä¸ªutils.jsæ–‡ä»¶ï¼Œå°†é˜²æŠ–å‡½æ•°æ”¾åœ¨é‡Œé¢

```js
// æ ¸å¿ƒåŸç†ï¼šå°±æ˜¯è®¾ç½®ä¸€ä¸ªæ—¶é—´ï¼Œç„¶åæ¯æ¬¡è°ƒç”¨å‰ï¼Œå…ˆåˆ¤æ–­æœ‰æ²¡æœ‰å·²ç»åˆ›å»ºçš„å®šæ—¶å™¨ï¼Œæœ‰å°±é”€æ¯ï¼Œå§‹ç»ˆä¿æŒåœ¨delayæ—¶é—´ä¸­åªæœ‰ä¸€ä¸ªå®šæ—¶å™¨çš„å­˜åœ¨
export function debounce(func, delay) {
  let timer = null
  return function (...args) {
    if (timer) clearTimeout(timer)
    timer = setTimeout(() => {
      func.apply(this, args)
    }, delay)
  }
}
```

å¯¹`home.vue`ä¸­çš„refreshçš„è°ƒç”¨æ·»åŠ é˜²æŠ–åŠ¨æ“ä½œ

```js
import {debounce} from "common/utils";
mounted() {
  // 1.å›¾ç‰‡åŠ è½½å®Œæˆçš„äº‹ä»¶ç›‘å¬
  const refresh = debounce(this.$refs.scroll.refresh, 50)
  this.$bus.$on('itemImageLoad', () => {
    refresh()
  })
},
```

![image-20241027120637926](assets/image-20241027120637926.png)